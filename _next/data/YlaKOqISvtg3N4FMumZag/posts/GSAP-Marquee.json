{"pageProps":{"title":"React Marquee","description":"An infinite carousel built using React and GSAP","image":"","content":"<h2 id=\"libraries\">Libraries</h2>\n<h3 id=\"react\">React</h3>\n<p><strong>useRef()</strong> is used to save DOM elements in a variable.<br><strong>useEffect()</strong> is used to:</p>\n<ol>\n<li>create new elements</li>\n<li>position the elements</li>\n<li>animate</li>\n</ol>\n<p><strong>createRef()</strong> creates references to the newly created elements.<br><strong>useState()</strong> stores strings and the widest element width.</p>\n<h3 id=\"gsap\">GSAP</h3>\n<p><strong>set()</strong> sets the position of the elements.<br><strong>to()</strong> animates the elements.</p>\n<h2 id=\"code-structure\">Code Structure</h2>\n<h3 id=\"cloning\">Cloning</h3>\n<ol>\n<li> Array of strings coming in as props to the marquee component</li>\n<li> Store each element as a ref</li>\n</ol>\n<pre><code class=\"language-javascript\">let els = useRef(items.map(() =&gt; createRef()));\n</code></pre>\n<ol start=\"3\">\n<li> Measure the width of the caontainer and the props</li>\n<li> Keep cloning elements if the container width is greater than the total width of the elements</li>\n<li>Find the widest element to offset the container with <!-- // if (maxWidth < width) {\n // maxWidth = width;\n // } --></li>\n</ol>\n<pre><code class=\"language-javascript\">const [items, setItems] = useState(props.data);\n\nuseEffect(() =&gt; {\n  let totalWidth = 0;\n  let arr = items;\n  while (totalWidth &lt; containerWidth) {\n    els.forEach((item, i) =&gt; {\n      let width = item.getBoundingClientRect().width;\n\n      if (totalWidth &lt; containerWidth) {\n        arr.push(item.textContent);\n      }\n      totalWidth = totalWidth + width;\n    });\n  }\n  setItems(arr);\n}, []);\n</code></pre>\n<h3 id=\"steps\">Steps</h3>\n<p>The elements are placed on the X-axis using gsap.set and the total width of the placed elements which accumulates throughout the iteration.</p>\n<pre><code class=\"language-javascript\">let accWidth = 0;\nels.forEach((item) =&gt; {\n  let width = item.getBoundingClientRect().width;\n  gsap.set(item, {\n    x: accWidth,\n  });\n  accWidth = accWidth + width;\n});\n</code></pre>\n<h3 id=\"animation\">Animation</h3>\n<p>Each item animates from its initial position to the total width of every element combined.\nWhen the element has reached the end, it has to place itself at the end of the row, this is done with a modulus of the total width using gsap.utils.wrap().\n<strong>Delta</strong> is either <strong>1</strong> or <strong>-1</strong> depending on the direction of the animation</p>\n<pre><code class=\"language-javascript\">const wrap = gsap.utils.wrap(0, accWidth);\nconst animation = gsap.to(els, {\n  x: `+=${accWidth * delta}`,\n  modifiers: {\n    x: gsap.utils.unitize(wrap),\n  },\n  duration: accWidth / 50,\n  ease: &#39;none&#39;,\n  repeat: -1,\n});\n</code></pre>\n<h3 id=\"render\">Render</h3>\n<pre><code class=\"language-javascript\">&lt;div ref={container}&gt;\n  &lt;ul style={{ left: -maxElWidth }}&gt;\n    {items.map((e, i) =&gt; (\n      &lt;li key={i} ref={(e) =&gt; (els[i] = e)}&gt;\n        {e}\n      &lt;/li&gt;\n    ))}\n  &lt;/ul&gt;\n&lt;/div&gt;\n</code></pre>\n<p>This is how I built my React marquee component using GSAP.</p>\n"},"__N_SSG":true}